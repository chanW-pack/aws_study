# AWS S3 버킷 버저닝, 수명 주기 설정

---

S3은 자체적으로 파일 버전 관리(Version Control) 기능을 내장하고 있다.

이 버저닝(Versioning) 기능을 활용하면 파일을이전 내용으로 되돌릴수 있고,

삭제한 파일도 복원할 수 있다.

단 그만큼 파일 저장 용량이 늘어나므로 사용 요금이 늘어난다.

따라서 용량이 작은 파일이 대부분일때 사용하는것을 권장한다.

![Untitled](AWS%20S3%20%E1%84%87%E1%85%A5%E1%84%8F%E1%85%B5%E1%86%BA%20%E1%84%87%E1%85%A5%E1%84%8C%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC,%20%E1%84%89%E1%85%AE%E1%84%86%E1%85%A7%E1%86%BC%20%E1%84%8C%E1%85%AE%E1%84%80%E1%85%B5%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%8C%E1%85%A5%E1%86%BC%20f03d517065074aa1ba13de6380de6608/Untitled.png)

> 버킷의 속성 탭에서 버킷 버전 관리 편집을 선택하여 이동한다.
Enable (활성화) 를 선택하여 기능을 사용할 수 있다.
> 

![Untitled](AWS%20S3%20%E1%84%87%E1%85%A5%E1%84%8F%E1%85%B5%E1%86%BA%20%E1%84%87%E1%85%A5%E1%84%8C%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC,%20%E1%84%89%E1%85%AE%E1%84%86%E1%85%A7%E1%86%BC%20%E1%84%8C%E1%85%AE%E1%84%80%E1%85%B5%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%8C%E1%85%A5%E1%86%BC%20f03d517065074aa1ba13de6380de6608/Untitled%201.png)

> 버저닝 기능을 활성화 한 뒤 S3 객체 목록에서 상단 버전 표시를 활성화하면
파일들의 버전이 표시된다.
> 

삭제된 파일을 Delete하면 복원되고, 최근 버전을 삭제하면 이전 버전으로 되돌릴 수 있다.

---

## S3 버킷 수명 주기 설정하기

---

S3은 버킷에 저장된 객체의 수명 주기(Lifecycle)를 관리할 수 있는 기능이 있다.

이 기능은 일정 시간이 지났을 때 사용되지 않는 파일들을 삭제하거나

다른 곳에 백업하여 S3 저장 공간을 절약하고 싶을 때 사용한다.

![Untitled](AWS%20S3%20%E1%84%87%E1%85%A5%E1%84%8F%E1%85%B5%E1%86%BA%20%E1%84%87%E1%85%A5%E1%84%8C%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC,%20%E1%84%89%E1%85%AE%E1%84%86%E1%85%A7%E1%86%BC%20%E1%84%8C%E1%85%AE%E1%84%80%E1%85%B5%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%8C%E1%85%A5%E1%86%BC%20f03d517065074aa1ba13de6380de6608/Untitled%202.png)

> S3 버킷 목록에서 버킷을 선택하고 관리 → 수명 주기 규칙을 선택 가능하다.
> 

규칙을 생성해보겠다.

![Untitled](AWS%20S3%20%E1%84%87%E1%85%A5%E1%84%8F%E1%85%B5%E1%86%BA%20%E1%84%87%E1%85%A5%E1%84%8C%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC,%20%E1%84%89%E1%85%AE%E1%84%86%E1%85%A7%E1%86%BC%20%E1%84%8C%E1%85%AE%E1%84%80%E1%85%B5%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%8C%E1%85%A5%E1%86%BC%20f03d517065074aa1ba13de6380de6608/Untitled%203.png)

> S3 버킷 수명 주기 설정
> 
- 수명 주기 규칙 이름
: 규칙의 이름이다. 입력하지 않으면 자동으로 생성된다.
- 규칙 범위 선택
: 특정 디렉토리의 파일들만 규칙을 적용시킬 수 있고, 버킷 내의 모든 파일에 적용시킬 수 있다.
lifecycle-folder 디렉터리를 생성하여 이에만 적용시킬 생각이므로
하나 이상의 필터… 옵션을 선택하고 버킷 이름을 제외한  폴더 경로를 적었다.

![Untitled](AWS%20S3%20%E1%84%87%E1%85%A5%E1%84%8F%E1%85%B5%E1%86%BA%20%E1%84%87%E1%85%A5%E1%84%8C%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC,%20%E1%84%89%E1%85%AE%E1%84%86%E1%85%A7%E1%86%BC%20%E1%84%8C%E1%85%AE%E1%84%80%E1%85%B5%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%8C%E1%85%A5%E1%86%BC%20f03d517065074aa1ba13de6380de6608/Untitled%204.png)

- 스토리지 클래스 간에 객체의 현재 버전 전환
: 원하는 스토리지 클래스 전환을 선택하고 객체 생성 후 경과 기간을 설정한다.
- 스토리지 클래스 간에객체의 이전 버전 전환
: 현재 버전 전환과 방법은 동일하다.
- 객체의 현재 버전 만료
: 날짜를 지정하면 그 날짜 기준으로 만료 상태로 변경 되며 시간이 좀 더 경과된 후 삭제
- 객체의 이전 버전 영구 삭제
: 설정된 날짜 기준으로 삭제
- 만료된 삭제 마케 또는 완료되지 않은 멀티파트 업로드 삭제
: 현재 날짜 기준으로 실행

마지막으로 스토리지 클래스를 선택하고, 객체 생성 후 경과 기간을  설정할 수 있다.

나는 30일 후, S3 Standard에서 S3 Standard-IA로 클래스가 전환되는 규칙을 생성했다.

<aside>
💡 예를 들어, 객체 생성일 기준으로 10일 후 데이터를 삭제 한다던지…..
30일 후 S3 Standard에서 S3 Standard-IA로 클래스를 전환 한다던지..등 다양한 
설정이 가능하다.

</aside>

---

## S3 버킷 기타 설정

---

S3 버킷은 앞서 설명한 것 이외에도 다양한 설정이 가능하다.

- Notifications 
: 낮은 중복 스토리지(Reduced Redundancy Storage)를 사용하는 객체가 유실됬을 때
SNS(Simple Notification Service) 로 알림을 전송해주는 기능이다.
- Tags
: 버킷에 태그를 설정한다. AWS의 Cost Allocation Reprots에서 S3의 비용 내역을 볼 수 있으며,
이 보고서는 여기서 설정한 태그 별로 집계된 사용 내역 및 비용이 표시된다.
- Requester Pays
: 기본적으로 S3 버킷 소유자는 사용 공간 및 데이터 전송량에 따른 요금을 지불하게 된다.
이 설정을 사용하면 버킷 소유자는 사용 공간에 대해서만 요금을 지불하면 되고,
데이터 전송량에 따른 요금은 데이터를 다운로드한 사용자가 지불하게 된다.

이 설정을 사용하면 버킷에 대한 익명 접근은 모두 차단된다.

---